<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link type="text/css" rel="stylesheet" href="../css/mui.min.css" />
		<link type="text/css" rel="stylesheet" href="../css/own.css" />
		<link type="text/css" rel="stylesheet" href="../css/iconfont/iconfont.css" />
		<link type="text/css" rel="stylesheet" href="../css/home.css" />
	</head>

	<body>
		<div id="homeDiv" class="mui-content own-content-padding">
			<div id="productSlider" class="mui-slider">
			</div>
			<div id="menus">
				<ul class="mui-table-view mui-grid-view mui-grid-9">
					<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
						<a href="#" cate="1" name="老人">
							<span><img src="../images/laoren.png" height="40"/></span>
							<div class="mui-media-body">老人</div>
						</a>
					</li>
					<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
						<a href="#" cate="2" name="儿童">
							<span><img src="../images/ertong.png" height="40"/></span>
							<div class="mui-media-body">儿童</div>
						</a>
					</li>
					<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
						<a href="#" cate="3" name="两性">
							<span><img src="../images/liangxing.png" height="40"/></span>
							<div class="mui-media-body">两性</div>
						</a>
					</li>
					<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
						<a href="#" cate="4" name="母婴">
							<span><img src="../images/muying.png" height="40"/></span>
							<div class="mui-media-body">母婴</div>
						</a>
					</li>
					<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
						<a href="#" cate="5" name="养生保健">
							<span><img src="../images/baojian.png" height="40"/></span>
							<div class="mui-media-body">养生保健</div>
						</a>
					</li>
					<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
						<a href="#" cate="6" name="皮肤护理">
							<span><img src="../images/pifu.png" height="40"/></span>
							<div class="mui-media-body">皮肤护理</div>
						</a>
					</li>
					<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
						<a href="#" cate="7" name="医疗器械">
							<span><img src="../images/yiliaoqx.png" height="40"/></span>
							<div class="mui-media-body">医疗器械</div>
						</a>
					</li>
					<li class="mui-table-view-cell mui-media mui-col-xs-3 mui-col-sm-3">
						<a href="#" cate="8" name="优惠券">
							<span><img src="../images/youhuiquan.png" height="40"/></span>
							<div class="mui-media-body">优惠券</div>
						</a>
					</li>
				</ul>
			</div>
			<div class="yb-ad1">
				<p class="ad-left">
					<img src="../images/default.png" class="adImg2"/>
				</p>
				<p class="ad-right">
					<img src="../images/default.png" class="adImg3"/>
					<img src="../images/default.png" class="adImg3"/>
				</p>
			</div>
			<div class="mui-content recommend">
				<ul class="mui-table-view mui-grid-view" id="recommend">
					
				</ul>
			</div>
			<div class="yb-ad1">
				<img src="../images/default.png" class="adImg4"/>
			</div>
			<div class="mui-content recommend">
				<ul class="mui-table-view mui-grid-view" id="hot">
					
				</ul>
			</div>
		</div>

		<script type="text/javascript" src="../js/mui.js" charset="UTF-8"></script>
		<script type="text/javascript" src="../js/common.js" charset="UTF-8"></script>
		<script type="text/javascript" src="../js/mui.lazyload.js" charset="UTF-8"></script>
		<script type="text/javascript" src="../js/mui.lazyload.img.js" charset="UTF-8"></script>
		<script type="text/javascript" src="../js/mui.zoom.js" charset="UTF-8"></script>
		<script type="text/javascript" src="../js/mui.previewimage.js" charset="UTF-8"></script>
		<script type="text/javascript" charset="UTF-8">
			mui.init({
				swipeBack: true //启用右滑关闭功能
			});
			//			mui.plusReady(function() {
			
			var honey=(function(h,$){
				/**
				 * 自动加载广告
				 */
				h.autoAd=function(){
					mui.ajax(h.apiurl,{
						data:{m:'ad_list'},
						type:'post',
						dataType:'json',
						success:function(ret){
							if(ret.code==0){
								h.showSlider(ret.data[1]);
								h.showAdImges(ret.data[2],2)
								h.showAdImges(ret.data[3],3)
								h.showAdImges(ret.data[4],4)
							}
						},
						error:function(ret){
							alert('error')
							alert(JSON.stringify(ret)) 
						} 
					})
				}
				/**
				 * 轮播图
				 * @param {Object} adList
				 */
				h.showSlider= function(adList) {
					var len=adList.length,
					    group = [],
						indicator = [];
					for(var i = 0; i <= len; i++) {
						if(i == 0) {
							group.push('<div class="mui-slider-item mui-slider-item-duplicate"><a href="#">\
								<img type="'+adList[len-1].ad_link_type+'" link="'+adList[len-1].ad_link_id+'" src="' + h.apihost+adList[len-1].ad_code + '"></a></div>')
						}
						if(i<len){
							group.push('<div class="mui-slider-item"><a href="#">\
								<img type="'+adList[i].ad_link_type+'" link="'+adList[i].ad_link_id+'" src="' + h.apihost+adList[i].ad_code + '"></a></div>')
							indicator.push('<div class="mui-indicator' + (i == 0 ? ' mui-active' : '') + '"></div>')
						}else {
							group.push('<div class="mui-slider-item mui-slider-item-duplicate"><a href="#">\
								<img type="'+adList[0].ad_link_type+'" link="'+adList[0].ad_link_id+'"  src="' + h.apihost+adList[0].ad_code + '"></a></div>')
						}
					}
					document.getElementById('productSlider').innerHTML = '<div class="mui-slider-group mui-slider-loop">' + group.join('') +
						'</div><div class="mui-slider-indicator">' + indicator.join('') + '</div>';
					h.slider = $('.mui-slider').slider({
						interval: 5000
					});
				}
				/**
				 * 显示广告图
				 * @param {Object} ad  广告数组
				 * @param {Object} obj 广告位置id
				 */
				h.showAdImges=function(ad,number){
					var obj=mui('.adImg'+number);
					for(var i=0;i<obj.length;i++){
						ad[i]&&obj[i].setAttribute('src',h.apihost+ad[i].ad_code)
					}
				}
				h.bindListTap= function() {
					//添加slider点击事件
					$('#productSlider').on('tap', 'a', function() {
						alert('a')
					})
					
					//添加每个item点击的监听事件
					$('.recommend').on('tap', 'a', function() {
						var goods_id = this.getAttribute('goods_id');
//						var title = this.querySelector('.goods-title').innerText;
						if(!h.detailWebView) {
							h.detailWebView = plus.webview.getWebviewById('goods-header');
						}
						if(!h.detailSubpage) {
							h.detailSubpage = plus.webview.getWebviewById('goods-detail');
						}
						$.fire(h.detailWebView, 'goodsId', {
							goods_id:goods_id
						})
						h.detailWebView.show('slide-in-right', 300)
					});
				}
				/**
				 * 获取首页商品
				 */
				h.loadGoods= function() {
					$.ajax(h.apiurl,{
						data:{m:'index_goods'},
						type:'post',
						dataType:'json',
						success:function(ret){ 
							if(ret.code==0){
								h.showGoodsList(ret.data.recommend,'recommend')
								h.showGoodsList(ret.data.hot,'hot')
							}
						},
						error:function(ret){
							alert('error')
							alert(JSON.stringify(ret)) 
						} 
					})
//					var recommend = document.getElementById('recommend');
//					var li=[];
//					for(var i = 0; i < 4; i++) {
//						var imageUrl = 'http://www.dcloud.io/hellomui/images/' + (i + 1) + '.jpg';
//						var innerHTML = '<div class="goods-list-item"><a href="' + i + '"><img class="mui-media-object goods-logo" src="../images/muwu.jpg"\
//							data-lazyload="' + imageUrl + '"/>\
//			                <div class="mui-media-body goods-info"><p class="goods-title">幸福就是可以一起睡觉...</p><p><span class="goods-price-one">￥120</span><span class="goods-price-two">￥200</span><p></div></a></div>';
//						li.push('<li class="mui-table-view-cell mui-media mui-col-xs-6 goods-list">'+innerHTML+'</li>');
//					}
//					recommend.innerHTML='<ul class="mui-table-view mui-grid-view">'+li.join('')+'</ul>';
				}
				/**
				 * 显示商品列表
				 * @param {Object} data
				 * @param {Object} id
				 */
//				showGoodsList:function(data,id){
//					var dom = document.getElementById(id);
//					var li=[];
//					mui.each(data,function(i,v){
//						li.push('<li class="mui-table-view-cell mui-media mui-col-xs-6 goods-list">\
//						<div class="goods-list-item">\
//							<a href="' + i + '"><img class="mui-media-object goods-logo" src="../images/logo.png" data-lazyload="' + apihost + v.sub_image + '_150_150.jpeg"/>\
//			                <div class="mui-media-body goods-info">\
//			                <p class="goods-title">'+v.goods_name +'</p>\
//			                <p><span class="goods-price-one">￥'+v.shop_price+'</span><p>\
//			                </div></a>\
//		                </div></li>');
//					})
//					dom.innerHTML='<ul class="mui-table-view mui-grid-view">'+li.join('')+'</ul>';
//					mui('#'+id).imageLazyload({
//						placeholder: '../images/60x60.gif'
//					});
//				},
				/**
				 * 绑定图标菜单触摸事件
				 */
				h.bindIconMenuTap=function(){
					mui('#menus').on('tap','a',function(){
						var name=this.getAttribute('name');
						var cate=this.getAttribute('cate');
						if(cate=='8'){
							alert('优惠券')
						}else{
//							openWin("../goods/goods-list-header.html","goods-list-header",{cate:cate},{top:0,bottom:'51px'})
							$.fire(h.goodsListHeader,'cateId',{name:name,cate:cate})
							h.goodsListHeader.show('slide-in-right',300)
						}
					})
				}
				return h;
			}(honey,mui))
			
			//			})
			mui.plusReady(function() {
				if(!honey.goodsListHeader){
					honey.goodsListHeader=plus.webview.getWebviewById('goods-list-header');
				}
				honey.autoAd()
				honey.bindIconMenuTap()
				honey.loadGoods()
				honey.bindListTap()
			})
		</script>
	</body>

</html>